<% 
  return unless comic
  javascript_include_tag :all
%>

<% content_for :og_meta_tags do %>
  <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
  <%
    og_tag_map = {
      "og:type" => 'article',
      "og:image" => URI.encode(comic.photo.url(:wide)),
      "og:title" => comic.title,
      "og:url" => URI.encode(comic_url(comic)),
      "article:author" => 'http://facebook.com/koos42',
      "article:published_time" => comic.date,
      "article:tag" => 'comics',
    }
    og_tag_map.each do |og_tag, value| %>
      <%= tag :meta, :property => og_tag, :content => value %>
    <% end %>
<% end %>

<%= javascript_include_tag "comic" %>

<div id="comic">
  <div id="photo">
    <%= image_tag comic.photo.url(:wide) %>
  </div>
  <div class="clear"> </div>

  <div id="comic_controls">
    <div class="comic_control prev">
      <% if comic.prev %>
        <%= link_to 'Previous', url_for(comic.prev) %>
      <% else %>
        <%= link_to 'Previous', '#', :class => 'disabled' %>
      <% end %>
    </div>
    <div class="comic_control next">
      <% if comic.next %>
        <%= link_to 'Next', url_for(comic.next) %>
      <% else %>
        <%= link_to 'Next', '#', :class => 'disabled' %>
      <% end %>
    </div>

    <%= render :partial => 'social_links', :locals => {:comic => comic } %>

  </div>  

  <%= render :partial => 'static/right_ad_rail' %>
  <div class="title-block">
    <%= image_tag (comic.thumbnail_url), :class => 'thumbnail' %>
    <h1 class="title"><%= comic.title %></h1>
    <div class="date"><%= comic.date %></div>
  </div>
  <div id="blurb" class="float-left"><%= raw(comic.blurb) %></div>
  <div id="comments" >
    <%= render :partial => 'comments', :locals => { :comic => comic } %>
  </div>
</div>
<% if user_is_author? %>
  <div id="author_actions">
    <div class="author_action edit">
      <%= link_to 'Edit', edit_comic_path(comic), :class => 'edit' %>
    </div>
    <div class="author_action destroy">
      <%= link_to 'Destroy', comic_url(comic)+"/destroy", :class => 'destroy', :confirm => "sure?" %>
    </div>
    <div class="author_action spacer">
      &nbsp;
    </div>
  </div>
<% end %>
